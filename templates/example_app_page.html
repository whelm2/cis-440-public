<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Example Page for Your App</title>

    <!-- External Fonts (Press Start 2P) -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <!-- Bootstrap 5 for layout and styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome for icons (e.g., power-off, send button) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

    <!-- Custom CSS for styling -->
    <link href="static/css/example_app_page.css" rel="stylesheet">

    <!-- Bootstrap JavaScript for interactivity and offcanvas functionality -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Socket.IO for real-time communication -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" integrity="sha384-2huaZvOR9iDzHqslqwpR87isEmrfxqyWOF7hr7BY6KG0+hVKLoEXMPUJw3ynWuhO" crossorigin="anonymous"></script>

    <!-- Data model that interacts with your API -->
    <script src="static/js/datamodel.js"></script> 

    <!-- JavaScript for handling websockets functionality -->
    <script src="static/js/chatsocket.js"></script> <!-- Manages WebSocket connections -->
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center">Welcome to Chatterbox!</h1>

        <!-- Nav tabs -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="main-tab" data-bs-toggle="tab" data-bs-target="#main" type="button" role="tab" aria-controls="main" aria-selected="true">Chat Rooms</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="account-management-tab" data-bs-toggle="tab" data-bs-target="#account-management" type="button" role="tab" aria-controls="account-management" aria-selected="false">Account Management</button>
            </li>
        </ul>

        <!-- Tab content -->
        <div class="tab-content mt-3" id="myTabContent">
            <!-- Main tab content -->
            <div class="tab-pane fade show active" id="main" role="tabpanel" aria-labelledby="main-tab">
                <!-- Menu Bar -->
                <div class="d-flex justify-content-between mb-3">
                    <!-- Existing Buttons -->
                    <div>
                        <button class="btn btn-primary me-2" onclick="loadChatroomsIntoTable()">
                            <i class="fas fa-sync-alt"></i> Refresh Chatroom List
                        </button>
                        <button class="btn btn-success" onclick="openAddChatroomModal()">
                            <i class="fas fa-user-plus"></i> Add a New Chatroom
                        </button>
                    </div>

                    <!-- Quick Chat Section -->
                    <div class="d-flex align-items-center">
                        <span class="me-2 text-nowrap">Quick Chat:</span>
                        <input type="text" id="quick_chat_message" class="form-control me-2" placeholder="Type a message...">
                        <select id="quick_chat_room" class="form-select me-2">
                            <option selected>Select a room...</option>
                            <!-- Additional room options can be added here -->
                        </select>
                        <button class="btn btn-primary" onclick="quickChatSend()">Send</button>
                    </div>
                </div>

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th scope="col">Chatroom</th>
                            <th scope="col">Description</th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>

            <!-- Account Management tab content -->
            <div class="tab-pane fade" id="account-management" role="tabpanel" aria-labelledby="account-management-tab">
                <h2>Manage Users</h2>

                <!-- Menu Bar -->
                <div class="d-flex justify-content-end mb-3">
                    <button class="btn btn-success me-2" onclick="openAddUserModal()">
                        <i class="fas fa-user-plus"></i> Add a New User
                    </button>
                    <button class="btn btn-primary" onclick="loadUsersIntoTable()">
                        <i class="fas fa-sync-alt"></i> Refresh User List
                    </button>
                </div>

                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th scope="col">Email</th>
                            <th scope="col">User Type</th>
                            <th scope="col">Description</th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>example1@email.com</td>
                            <td>
                                User 1 description goes here.
                            </td>
                            <td>
                                <button class="btn btn-primary btn-sm me-2">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-danger btn-sm">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td>example2@email.com</td>
                            <td>
                                User 2 description goes here.
                            </td>
                            <td>
                                <button class="btn btn-primary btn-sm me-2">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-danger btn-sm">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td>example3@email.com</td>
                            <td>
                                User 3 description goes here.
                            </td>
                            <td>
                                <button class="btn btn-primary btn-sm me-2">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-danger btn-sm">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>


   <!-- Modal for Adding a New User -->
<div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addUserModalLabel">Create New Account</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addUserForm">
                    <!-- Email input -->
                    <div class="mb-3">
                        <label for="email" class="form-label">Email address</label>
                        <input type="email" class="form-control" id="email" name="email" placeholder="Enter email" required>
                    </div>
                    <!-- Password input -->
                    <div class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" name="password" placeholder="Enter password" required>
                    </div>
                    <!-- Description input -->
                    <div class="mb-3">
                        <label for="description" class="form-label">Description</label>
                        <textarea class="form-control" id="description" name="description" rows="3" placeholder="Enter description" required></textarea>
                    </div>
                    <!-- Administrator checkbox -->
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="isAdmin" name="isAdmin">
                        <label class="form-check-label" for="isAdmin">Account will be an administrator</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button id="modalCreateButton" type="submit" class="btn btn-primary" form="addUserForm">Create Account</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Editing a User -->
<div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editUserModalLabel">Edit User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editUserForm">
                    <!-- Email input -->
                    <div class="mb-3">
                        <label for="editEmail" class="form-label">Email address</label>
                        <input type="email" class="form-control" id="editEmail" name="email" placeholder="Enter email" required>
                    </div>
                    <!-- Description input -->
                    <div class="mb-3">
                        <label for="editDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="editDescription" name="description" rows="3" placeholder="Enter description" required></textarea>
                    </div>
                    <!-- Administrator checkbox -->
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="editIsAdmin" name="isAdmin">
                        <label class="form-check-label" for="editIsAdmin">Account will be an administrator</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button id="modalEditButton" type="submit" class="btn btn-primary" form="editUserForm">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Adding a New Chatroom -->
<div class="modal fade" id="addChatroomModal" tabindex="-1" aria-labelledby="addChatroomModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addChatroomModalLabel">Create New Chatroom</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addChatroomForm">
                    <!-- Chatroom name input -->
                    <div class="mb-3">
                        <label for="chatroomName" class="form-label">Chatroom Name</label>
                        <input type="text" class="form-control" id="chatroomName" name="name" placeholder="Enter chatroom name" required>
                    </div>
                    <!-- Description input -->
                    <div class="mb-3">
                        <label for="chatroomDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="chatroomDescription" name="description" rows="3" placeholder="Enter description" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button id="modalCreateChatroomButton" type="submit" class="btn btn-primary" form="addChatroomForm">Create Chatroom</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Editing a Chatroom -->
<div class="modal fade" id="editChatroomModal" tabindex="-1" aria-labelledby="editChatroomModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editChatroomModalLabel">Edit Chatroom</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editChatroomForm">
                    <!-- Chatroom name input -->
                    <div class="mb-3">
                        <label for="editChatroomName" class="form-label">Chatroom Name</label>
                        <input type="text" class="form-control" id="editChatroomName" name="name" placeholder="Enter chatroom name" required>
                    </div>
                    <!-- Description input -->
                    <div class="mb-3">
                        <label for="editChatroomDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="editChatroomDescription" name="description" rows="3" placeholder="Enter description" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button id="modalEditChatroomButton" type="submit" class="btn btn-primary" form="editChatroomForm">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Displaying Chatroom Messages -->
<div class="modal fade" id="displayChatroomModal" tabindex="-1" aria-labelledby="displayChatroomModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
                <h5 class="modal-title" id="displayChatroomModalLabel">Chatroom Name</h5> <!-- Title for chatroom name -->
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body d-flex flex-column" style="height: 70vh;">
                <!-- Scrollable chat messages area -->
                <div id="chatroomMessages" class="flex-grow-1 overflow-auto mb-3 p-2 border rounded" style="background-color: #f8f9fa;">
                    <!-- Messages will be displayed here -->
                </div>

                <!-- Message input area -->
                <div class="d-flex">
                    <textarea id="chatMessageInput" class="form-control" placeholder="Type your message here..." rows="1" style="resize: none;"></textarea>
                    <button type="button" class="btn btn-primary ms-2" onclick="sendChatMessage()" style="height: 100%;">Send</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="static/js/example_app_page.js"></script> <!-- Handles user interactions on the websocket -->

</body>
</html>
